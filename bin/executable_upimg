#!/usr/bin/env bash

# https://github.com/jcsalterego/pngpaste
# brew install pngpaste
set -e
img_path=~/workspace/images/

if [ ! -d $img_path ]; then
  git clone https://git.home.lubui.com:8443/urie/images.git ~/workspace/images/
  git remote add github git@github.com:Urie96/images.git
  # https://git.home.lubui.com:8443/urie/images/raw/branch/main/test.png
fi
git pull origin main
git pull github main

name=$1$(date +"%Y%m%d%H%M%S").jpg
pngpaste - >>/dev/null # 判断是否有图片
pngpaste - >$name

git add $name
git commit -m "upload $name"
git push origin main
git push github main

github_url=https://cdn.jsdelivr.net/gh/Urie96/images/$name
gitea_url=https://git.home.lubui.com:8443/urie/images/raw/branch/main/$name
echo ""
echo "Github: $github_url"
echo "Gitea: $gitea_url"
echo $gitea_url | pbcopy
